package org.honton.chas.jca.vault.provider.keygen;

import java.math.BigInteger;
import java.security.interfaces.ECPublicKey;
import java.security.interfaces.RSAPublicKey;
import java.security.spec.ECPoint;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

class Pkcs8Test {

  private static final String ECDSAp256 =
      "-----BEGIN PUBLIC KEY-----\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE57yNUD8JUsnLUz83hm5htTbClRZT\nSBm8eCiMUghHteb4tTm4CUauXv6JEz97D2XLdfsN2W30Yh6F1U7yWjYSJg==\n-----END PUBLIC KEY-----\n";
  private static final String RSA2048 =
      "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwu/UrOfeZmPj3kMXzVvs\nqVjMRYPWNxHWDbM8TvFo2FSs8B89c1gl+qxacSgsGJbivcCmXB3+Muas8omg82Tw\nk/3MOZJR7drOm76mO3e0HNC2WUXW1oRYHGJBIsgoCSk9k5FB86SFscPhTL6VeRJt\nOt9sd/XS8Zw6ddtFMG0MQ9jE4QoGu6z3KcGEQ3hjXqgvI89HblZIy0aiiuaMU4nc\nHnT3zp0L7ft9VmjRlVHt+9MxMbQcGMg7upegCXYm68XpVMv+9u94IRXfuxV22dwt\nBE014zhbA6721he55goLtOdMVYRikluHKhRMsHpplV1gGkpBUQsQISOAuVc+Ukou\nEQIDAQAB\n-----END PUBLIC KEY-----\n";

  @Test
  void ecdsa() {
    ECPublicKey key = (ECPublicKey) Pkcs8.getPublicKeyFromString(ECDSAp256);
    Assertions.assertEquals(
        new ECPoint(
            new BigInteger(
                "104817410580582012605720425323098910544946577169443364798542658422287653909990"),
            new BigInteger(
                "112493784128523792856371165623959467964739993251933920399156308415723827761702")),
        key.getW());
  }

  @Test
  void rsa() {
    RSAPublicKey key = (RSAPublicKey) Pkcs8.getPublicKeyFromString(RSA2048);
    Assertions.assertEquals(new BigInteger("65537"), key.getPublicExponent());
    Assertions.assertEquals(
        new BigInteger(
            "24608496120609784878849708276257552230304793049477656549314247430204648878893602195333103355135523847601689839789430038159974857877430847540472889083691363742492706252471954993660302249500613495396427952563726124874120886510275044182377075112195212215317696810490665329368598055313256295516091029288442432954135160903174512835037526787150507729877282399410720491816263721142851694862077485042819528046493312681142813056298571128939967433309243747615223721502488919726683510415973597836621627815710703698797794156117489292423903048782591597020614609076059327646873434051860314720760502766751397687871212888302925000209"),
        key.getModulus());
  }
}
